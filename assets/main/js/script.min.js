import{preloadImages}from"../../libs/utils.js";$=jQuery;let lenis=new Lenis;function loading(){if(document.querySelector(".loading")){let t=document.getElementById("logo"),r=document.querySelector(".loading");var e=window.innerHeight-173;gsap.set(t,{y:e,scale:145/28}),gsap.set(r,{"--after-height":"0px"}),gsap.to(t,{y:0,duration:2,ease:"expo.in",onUpdate:function(){var e=t.getBoundingClientRect().top,e=window.innerHeight-e+15;gsap.set(r,{"--after-height":e+"px"})},onComplete:()=>{gsap.to(t,{scale:1,duration:1,ease:"expo.in",onComplete:()=>{document.querySelector(".loading").classList.add("loaded")}})}})}}function sectionFields(){$(".section-fields").length<1||(gsap.utils.toArray(".fields-item").forEach((e,t,r)=>{var o=e.querySelector(".fields-item-img"),a=e.querySelector(".fields-item-name h3"),s=e.querySelector(".fields-item-name .desc"),a=(ScrollTrigger.create({trigger:e,start:"top bottom",end:"top top",scrub:.5,animation:gsap.fromTo(o,{clipPath:"inset(100px 100px 100px 100px)"},{clipPath:"inset(0px 0px 0px 0px)",ease:"none"})}),t<r.length-1&&ScrollTrigger.create({trigger:e,start:"bottom bottom",end:"bottom top",scrub:.5,animation:gsap.fromTo(o,{clipPath:"inset(0px 0px 0px 0px)"},{clipPath:"inset(100px 100px 100px 100px)",ease:"none"})}),a&&(r=SplitText.create(a,{type:"chars",mask:"chars"}),gsap.set(r.chars,{y:"125%"}),gsap.timeline({scrollTrigger:{trigger:e,start:"top 20%",toggleActions:"play none none none"}}).to(r.chars,{y:"0%",ease:"power2.out",duration:.6,stagger:.03})),s&&(o=new SplitText(s,{type:"lines",linesClass:"line",mask:"lines"}),gsap.set(o.lines,{yPercent:100}),gsap.timeline({scrollTrigger:{trigger:e,start:"top 20%",toggleActions:"play none none none"}}).to(o.lines,{yPercent:0,ease:"power2.out",duration:.8,stagger:.1})),e.querySelector(".fields-item-img img"));a&&gsap.fromTo(a,{scale:1.3},{scale:1,ease:"none",scrollTrigger:{trigger:a,start:"top bottom",end:"top top",scrub:1}}),ScrollTrigger.create({trigger:e,start:"top center",end:"bottom center",onEnter:()=>{$(".fields-tabs__item").removeClass("active"),$(".fields-tabs__item").eq(t).addClass("active")},onEnterBack:()=>{$(".fields-tabs__item").removeClass("active"),$(".fields-tabs__item").eq(t).addClass("active")}})}),ScrollTrigger.create({trigger:".section-fields",start:"top top",end:"bottom+=40 bottom",onEnter:()=>{$(".fields-tabs").addClass("active")},onLeave:()=>{$(".fields-tabs").removeClass("active")},onEnterBack:()=>{$(".fields-tabs").addClass("active")},onLeaveBack:()=>{$(".fields-tabs").removeClass("active")}}))}function magicCursor(){var t=document.querySelector(".magic-cursor");gsap.set(t,{xPercent:-50,yPercent:-50});let r,o;window.addEventListener("mousemove",e=>{r=e.clientX,o=e.clientY,gsap.to(t,{x:r,y:o,duration:.1})});var e=document.querySelectorAll(".modal, [data-cursor-text]"),a=document.querySelector(".magic-cursor .cursor"),s=document.querySelector(".magic-cursor .cursor .text");e.forEach(t=>{t.addEventListener("mouseenter",()=>{let e="";e=t.classList.contains("modal")?"Đóng":t.getAttribute("data-cursor-text"),s.innerHTML=`<span class="color-white">${e}</span>`,a.classList.add("show-text")}),t.addEventListener("mouseleave",()=>{s.innerHTML="",a.classList.remove("show-text")})}),document.querySelectorAll(".modal-dialog").forEach(e=>{e.addEventListener("mouseenter",()=>{a.classList.remove("show-text")}),e.addEventListener("mouseleave",()=>{s.innerHTML='<span class="color-white">Đóng</span>',a.classList.add("show-text")})})}function effectText(){gsap.registerPlugin(ScrollTrigger,SplitText),gsap.utils.toArray(".data-fade-in").forEach(e=>{var t=parseFloat(e.getAttribute("data-delay"))||0;gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:40},{scrollTrigger:{trigger:e,start:"top 80%",end:"bottom 80%"},opacity:1,delay:t,y:0,duration:.6,ease:"sine.out"})}),gsap.utils.toArray(".effect-line-auto").forEach(e=>{var t=parseFloat(e.getAttribute("data-delay"))||0,e=new SplitText(e,{type:"lines",linesClass:"line",mask:"lines"});gsap.fromTo(e.lines,{yPercent:100,willChange:"transform"},{yPercent:0,duration:1,ease:"power3.out",stagger:.05,delay:t})}),gsap.utils.toArray(".effect-line").forEach(e=>{var t=new SplitText(e,{type:"lines",linesClass:"line",mask:"lines"});gsap.fromTo(t.lines,{yPercent:100,willChange:"transform"},{yPercent:0,duration:1,ease:"power3.out",stagger:.05,scrollTrigger:{trigger:e,start:"top 80%"}})}),gsap.utils.toArray(".effect-line-box").forEach(e=>{var t=new SplitText(e,{type:"lines",linesClass:"line",mask:"lines"});gsap.fromTo(t.lines,{yPercent:100,willChange:"transform"},{yPercent:0,duration:1,ease:"power3.out",scrollTrigger:{trigger:e,start:"top 80%"}})}),gsap.utils.toArray(".effect-title-auto").forEach(e=>{var t=parseFloat(e.getAttribute("data-delay"))||0,e=SplitText.create(e,{type:"words,chars",mask:"words"});gsap.set(e.chars,{y:"125%"}),gsap.to(e.chars,{y:"0%",ease:"power3.out",duration:1,stagger:.03,delay:t})}),gsap.utils.toArray(".effect-title").forEach(e=>{var t=parseFloat(e.getAttribute("data-delay"))||0,r=new SplitText(e,{type:"chars, words",charsClass:"char",mask:"chars"});gsap.set(r.chars,{y:"125%",opacity:0}),gsap.to(r.chars,{y:"0%",opacity:1,ease:"power3.out",duration:1,stagger:.03,delay:t,scrollTrigger:{trigger:e,start:"top 80%",toggleActions:"play none none none"}})}),gsap.registerPlugin(ScrollTrigger,SplitText),document.querySelectorAll(".scroll-wrap-item").forEach(e=>{var t=e.querySelector(".scroll-wrap-image"),r=e.querySelector(".title-box"),o=e.querySelector(".description-box"),e=gsap.timeline({scrollTrigger:{trigger:e,start:"top 70%",toggleActions:"play none none none"}});t&&(gsap.set(t,{opacity:0,y:30}),e.to(t,{opacity:1,y:0,duration:.8,ease:"power2.out"})),r&&(t=parseFloat(r.getAttribute("data-delay"))||0,r=new SplitText(r,{type:"chars,words",charsClass:"char",mask:"chars"}),gsap.set(r.chars,{y:"125%",opacity:0}),e.to(r.chars,{y:"0%",opacity:1,duration:1,ease:"power3.out",stagger:.03},"-="+(.8-t))),o&&(r=parseFloat(o.getAttribute("data-delay"))||0,t=new SplitText(o,{type:"lines",linesClass:"line",mask:"lines"}),gsap.set(t.lines,{yPercent:100,willChange:"transform"}),e.fromTo(t.lines,{yPercent:100},{yPercent:0,duration:1,ease:"power3.out",stagger:.08,delay:r},"<"))})}function customDropdown(){let e=document.querySelectorAll(".dropdown-custom");function s(o){e.forEach(e=>{var t=e.querySelector(".dropdown-custom-menu"),r=e.querySelector(".dropdown-custom-btn");o&&e===o||(t.classList.remove("dropdown--active"),r.classList.remove("--active"))})}e.forEach(t=>{let r=t.querySelector(".dropdown-custom-btn"),o=t.querySelector(".dropdown-custom-menu");var e=t.querySelectorAll(".dropdown-custom-item");let a=t.querySelector(".value-select");r.addEventListener("click",function(e){e.stopPropagation(),s(t),o.classList.toggle("dropdown--active"),r.classList.toggle("--active")}),document.addEventListener("click",function(){s()}),e.forEach(o=>{o.addEventListener("click",function(e){e.stopPropagation();var e=a.querySelector("img"),e=e?e.src:"",t=a.querySelector("span").textContent,r=(a.innerHTML,o.innerHTML),r=(a.innerHTML=r,"Time"===t.trim());r||(o.innerHTML=e?`<span>${t}</span><img src="${e}" alt="" />`:`<span>${t}</span>`),s()})}),window.addEventListener("scroll",function(){o.closest(".header-lang")&&(o.classList.remove("dropdown--active"),r.classList.remove("--active"))})})}function hero(){$("section.hero").length<1||(document.querySelector(".swiper-banner .progress-bar"),new Swiper(".swiper-banner",{loop:!0,speed:1500,grabCursor:!0,watchSlidesProgress:!0,mousewheelControl:!0,keyboardControl:!0,navigation:{nextEl:".swiper-banner .swiper-next",prevEl:".swiper-banner .swiper-prev"},pagination:{el:".swiper-banner .swiper-pagination",type:"progressbar"},autoplay:{delay:5e3,disableOnInteraction:!1},on:{progress:function(r){r.slides.forEach(function(e){var t=(e.progress||0)*(.9*r.width);isNaN(t)||(e=e.querySelector(".slide-banner"))&&(e.style.transform="translate3d("+t+"px, 0, 0)")})},touchStart:function(e){e.slides.forEach(function(e){e.style.transition=""})},setTransition:function(e,t){var r="cubic-bezier(0.25, 0.1, 0.25, 1)";e.slides.forEach(function(e){e.style.transition=t+"ms "+r;e=e.querySelector(".slide-banner");e&&(e.style.transition=t+"ms "+r)})}}}),0<$("section.hero").length&&0<$("section.intro").length&&ScrollTrigger.create({start:0,end:"max",onUpdate:e=>{var t=1.4*window.innerHeight;e.scroll()>=t?$(".hero").addClass("hidden-section"):$(".hero").removeClass("hidden-section")}}))}function sectionIntro(){$("section.intro").length<1||($(".intro-overlay").length&&gsap.to(".intro-overlay",{y:-100,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 60%",end:"+=300",scrub:!0}}),gsap.utils.toArray([".image-small img",".image-large img"]).forEach(e=>{gsap.fromTo(e,{scale:1.2},{scale:1,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),gsap.utils.toArray([".image-small img",".image-large img"]).forEach(e=>{gsap.fromTo(e,{scale:1.2},{scale:1,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),gsap.utils.toArray(".item-translate").forEach(e=>{var t=parseFloat(e.getAttribute("data-y"))||0;gsap.to(e,{y:t,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),0<$("section.hero").length&&0<$("section.intro").length&&gsap.to(".hero",{y:-200,ease:"none",scrollTrigger:{trigger:".intro",start:"top 60%",end:"top top",scrub:!0}}))}function scrollWrap(){document.querySelectorAll(".scroll-wrap").length<1||document.querySelectorAll(".scroll-wrap").forEach(e=>{var t=e.querySelectorAll(".scroll-trigger");let o=e.querySelectorAll(".scroll-item");t.forEach((e,t)=>{var r=o[t];0===t?gsap.timeline({scrollTrigger:{trigger:e,start:"top top",end:"bottom top",scrub:!0},defaults:{ease:"none"}}).fromTo(r,{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)"},{clipPath:"polygon(0% 0%, 100% 0%, 100% 0%, 0% 0%)"}):t===o.length-1?gsap.timeline({scrollTrigger:{trigger:e,start:"top bottom",end:"bottom bottom",scrub:!0},defaults:{ease:"none"}}).fromTo(r,{clipPath:"polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"},{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)"}):((t=gsap.timeline({scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:!0},defaults:{ease:"none"}})).fromTo(r,{clipPath:"polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"},{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)"}),t.to(r,{clipPath:"polygon(0% 0%, 100% 0%, 100% 0%, 0% 0%)"}))})})}function sectionAwards(){$(".section-awards").length<1||(document.querySelectorAll(".section-awards").forEach(e=>{var t=e.querySelector(".awards-slider"),r=e.id.includes("awards");new Swiper(t,{slidesPerView:r?2:4,spaceBetween:30,loop:!1,speed:800,autoplay:!1,navigation:{prevEl:e.querySelector(".arrow-prev"),nextEl:e.querySelector(".arrow-next")},breakpoints:{768:{slidesPerView:r?3:4},480:{slidesPerView:2},0:{slidesPerView:1}}})}),gsap.utils.toArray(".section-awards").forEach(e=>{var t=e.querySelectorAll(".news-item");gsap.set(t,{y:40,opacity:0}),gsap.timeline({scrollTrigger:{trigger:e,start:"top 70%",end:"bottom bottom",toggleActions:"play none none none"}}).to(t,{y:0,opacity:1,duration:.6,ease:"power2.out",stagger:.2})}))}function ticket(){var e=document.querySelectorAll(".ticket");e.length&&e.forEach(e=>{var t=e.querySelector(".ticket-inner"),r=t.querySelector(".ticket-content"),e=parseFloat(e.getAttribute("data-ticket-duration"))||10;t.innerHTML="",t.append(r);for(let e=0;e<20;e++){var o=r.cloneNode(!0);t.append(o)}var a=gsap.utils.toArray(".ticket-content",t);let s=r.offsetWidth;gsap.to(a,{x:-s,repeat:-1,duration:e,ease:"linear",modifiers:{x:gsap.utils.unitize(e=>parseFloat(e)%s)}}),t.querySelectorAll(".diamond").forEach(e=>{gsap.to(e,{rotation:-360,repeat:-1,duration:3,ease:"linear"})})})}function responsibility(){var e;$(".responsibility").length<1||(e=gsap.utils.toArray(".responsibility .responsibility-item"),gsap.set(e,{y:50,opacity:0}),gsap.timeline({scrollTrigger:{trigger:".responsibility-grid",start:"top 70%",end:"bottom bottom",toggleActions:"play none none none"}}).to(e,{y:0,opacity:1,duration:.6,ease:"power2.out",stagger:.2}),$(".responsibility .responsibility-item").mousemove(function(e){var t=$(this).offset(),r=e.pageX-t.left,e=e.pageY-t.top;$(this).css("--x",r+"px"),$(this).css("--y",e+"px")}))}function parallaxSection(){$(".parallax-section").length<1||$(".parallax-section").each(function(){var e=$(this),t=e.find(".section-overlay-parallax");t.length<1||gsap.to(t,{y:-200,ease:"none",scrollTrigger:{trigger:e[0],start:"top 80%",end:"bottom top",scrub:!0}})})}function hideMenuOnFooter(){gsap.registerPlugin(ScrollTrigger),ScrollTrigger.create({trigger:"body",start:"top top-=180vh",end:"bottom bottom",onEnter:()=>{document.querySelector(".chat-button").classList.add("show-chat")},onLeaveBack:()=>{document.querySelector(".chat-button").classList.remove("show-chat")}}),ScrollTrigger.create({trigger:"body",start:"top top-=180vh",end:"bottom bottom",onEnter:()=>{document.querySelector(".menu-fixed-bottom").classList.add("show-menu-fixed")},onLeaveBack:()=>{document.querySelector(".menu-fixed-bottom").classList.remove("show-menu-fixed")}}),ScrollTrigger.create({trigger:"footer",start:"top bottom+=50",end:"bottom bottom",onEnter:()=>{document.querySelector(".menu-fixed-bottom").classList.add("hide-menu-fixed")},onLeaveBack:()=>{document.querySelector(".menu-fixed-bottom").classList.remove("hide-menu-fixed")}});var e=document.querySelector("footer").offsetHeight;gsap.fromTo(".footer-main",{y:100},{y:0,ease:"none",scrollTrigger:{trigger:"body",start:`bottom-=${e} bottom`,end:"bottom bottom",scrub:!0,toggleActions:"play reverse play reverse"}})}function wipe(){document.querySelector(".wipe")&&(gsap.registerPlugin(ScrollTrigger),document.querySelectorAll(".wipe").forEach(e=>{var t=e.querySelector(".wipe-image");gsap.set(t,{"--clip":"inset(0% 0% 0% 0%)"}),gsap.to(t,{"--clip":"inset(0% 0% 100% 0%)",duration:1.6,ease:"power3.out",scrollTrigger:{trigger:e,start:"top 40%",end:"top 30%"}})}))}function hoverVideo(){$(".item-hover-video").length<1||document.querySelectorAll(".item-hover-video").forEach(e=>{let t=e.querySelector("video");e.addEventListener("mouseenter",()=>{t.loop=!0,t.play()}),e.addEventListener("mouseleave",()=>{t.pause(),setTimeout(()=>{t.currentTime=0,t.load()},500)})})}function scrollTop(){$('a[href*="#"]').on("click",function(e){var t=this.getAttribute("href"),r=t.indexOf("#");-1!==r&&(t=t.slice(r),window.location.pathname.replace(/\/$/,"")===(r=this.pathname.replace(/\/$/,""))||""===r)&&(e.preventDefault(),(r=$(t)).length)&&(e=$("header").outerHeight()||0,lenis.scrollTo(r[0],{offset:-e,duration:.6,easing:e=>e}))})}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),loading(),magicCursor(),effectText(),customDropdown(),hero(),sectionIntro(),scrollWrap(),sectionAwards(),ticket(),responsibility(),parallaxSection(),hideMenuOnFooter(),wipe(),hoverVideo(),scrollTop(),ScrollTrigger.refresh()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0)}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});