import{preloadImages}from"../../libs/utils.js";$=jQuery;let lenis=new Lenis;function loading(){if(document.querySelector(".loading")){let t=document.getElementById("logo"),o=document.querySelector(".loading");var e=window.innerHeight-173;gsap.set(t,{y:e,scale:145/28}),gsap.set(o,{"--after-height":"0px"}),gsap.to(t,{y:0,duration:2.5,onUpdate:function(){var e=t.getBoundingClientRect().top,e=window.innerHeight-e+12;gsap.set(o,{"--after-height":e+"px"})},onComplete:()=>{gsap.to(t,{scale:1,duration:1,onComplete:()=>{document.querySelector(".loading").classList.add("loaded")}})}})}}function sectionFields(){$(".section-fields").length<1||gsap.utils.toArray(".fields-item").forEach(o=>{var e=o.querySelector(".fields-item-img"),t=o.querySelector(".fields-item-name h3"),r=o.querySelector(".fields-item-name .desc"),e=(ScrollTrigger.create({trigger:o,start:"top bottom",end:"top top",scrub:.5,animation:gsap.fromTo(e,{clipPath:"polygon(25% 25%, 75% 40%, 100% 100%, 0% 100%)"},{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",ease:"none"})}),ScrollTrigger.create({trigger:o,start:"bottom bottom",end:"bottom top",scrub:.5,animation:gsap.fromTo(e,{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)"},{clipPath:"polygon(0% 0%, 100% 0%, 75% 60%, 25% 75%)",ease:"none"})}),t&&(e=SplitText.create(t,{type:"chars",mask:"chars"}),gsap.set(e.chars,{y:"125%"}),e.chars.forEach((e,t)=>{ScrollTrigger.create({trigger:o,start:`top+=${25*t} center`,end:`top+=${25*t} 40%`,scrub:1,animation:gsap.fromTo(e,{y:"125%"},{y:"0%",ease:"none"})})})),r&&(t=new SplitText(r,{type:"lines",linesClass:"line",mask:"lines"}),gsap.set(t.lines,{yPercent:100}),ScrollTrigger.create({trigger:o,start:"top center",end:"top top",scrub:1,animation:gsap.to(t.lines,{yPercent:0,ease:"none"})})),o.querySelector(".fields-item-img img"));e&&gsap.fromTo(e,{scale:1.3},{scale:1,ease:"none",scrollTrigger:{trigger:e,start:"top bottom",end:"top top",scrub:1}})})}function magicCursor(){var t=document.querySelector(".magic-cursor");gsap.set(t,{xPercent:-50,yPercent:-50});let o,r;window.addEventListener("mousemove",e=>{o=e.clientX,r=e.clientY,gsap.to(t,{x:o,y:r,duration:.1})});var e=document.querySelectorAll(".modal, [data-cursor-text]"),a=document.querySelector(".magic-cursor .cursor"),s=document.querySelector(".magic-cursor .cursor .text");e.forEach(t=>{t.addEventListener("mouseenter",()=>{let e="";e=t.classList.contains("modal")?"Đóng":t.getAttribute("data-cursor-text"),s.innerHTML=`<span class="b2-regular color-white">${e}</span>`,a.classList.add("show-text")}),t.addEventListener("mouseleave",()=>{s.innerHTML="",a.classList.remove("show-text")})}),document.querySelectorAll(".modal-dialog").forEach(e=>{e.addEventListener("mouseenter",()=>{a.classList.remove("show-text")}),e.addEventListener("mouseleave",()=>{s.innerHTML='<span class="b2-regular color-white">Đóng</span>',a.classList.add("show-text")})})}function effectText(){gsap.registerPlugin(ScrollTrigger,SplitText),gsap.utils.toArray(".data-fade-in").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{scrollTrigger:{trigger:e,start:"top 80%",end:"bottom 80%"},opacity:1,y:0,duration:.5,ease:"sine.out"})}),gsap.utils.toArray(".effect-line").forEach(e=>{var t=new SplitText(e,{type:"lines",linesClass:"line",mask:"lines"});gsap.fromTo(t.lines,{yPercent:100,willChange:"transform"},{yPercent:0,duration:1,ease:"power3.out",stagger:.05,scrollTrigger:{trigger:e,start:"top 80%"}})}),gsap.utils.toArray(".effect-title-auto").forEach(e=>{var t=parseFloat(e.getAttribute("data-delay"))||0,e=SplitText.create(e,{type:"chars",mask:"chars"});gsap.set(e.chars,{y:"125%"}),gsap.to(e.chars,{y:"0%",ease:"power3.out",duration:1,stagger:.03,delay:t})})}function customDropdown(){let e=document.querySelectorAll(".dropdown-custom");function s(r){e.forEach(e=>{var t=e.querySelector(".dropdown-custom-menu"),o=e.querySelector(".dropdown-custom-btn");r&&e===r||(t.classList.remove("dropdown--active"),o.classList.remove("--active"))})}e.forEach(t=>{let o=t.querySelector(".dropdown-custom-btn"),r=t.querySelector(".dropdown-custom-menu");var e=t.querySelectorAll(".dropdown-custom-item");let a=t.querySelector(".value-select");o.addEventListener("click",function(e){e.stopPropagation(),s(t),r.classList.toggle("dropdown--active"),o.classList.toggle("--active")}),document.addEventListener("click",function(){s()}),e.forEach(r=>{r.addEventListener("click",function(e){e.stopPropagation();var e=a.querySelector("img"),e=e?e.src:"",t=a.querySelector("span").textContent,o=(a.innerHTML,r.innerHTML),o=(a.innerHTML=o,"Time"===t.trim());o||(r.innerHTML=e?`<img src="${e}" alt="" /><span>${t}</span>`:`<span>${t}</span>`),s()})}),window.addEventListener("scroll",function(){r.closest(".header-lang")&&(r.classList.remove("dropdown--active"),o.classList.remove("--active"))})})}function hero(){$("section.hero").length<1||$(".hero-slider").each(function(){var e=$(this);let t;var o=e.attr("data-loop"),r=e.data("autoplay")?{delay:e.data("autoplay")}:e.data("autoplay");t=e.is("[data-speed]")?e.data("speed"):900,new Swiper(e[0],{direction:"horizontal",rtl:!0,speed:t,loop:o,autoplay:r,preloadImages:!0,parallax:!0,lazy:{loadPrevNext:!0},allowTouchMove:!1,simulateTouch:!1,mousewheel:!1,pagination:{el:".hero .swiper-pagination",clickable:!1,renderBullet:function(e,t){return`
            <button class="${t}">
            <svg class="progress" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle class="circle-origin" cx="14" cy="14" r="13" stroke="white"/>
            </svg>
            </button>`}},on:{init:function(){$(this.slides[this.activeIndex])}}})})}function sectionIntro(){$("section.intro").length<1||(gsap.to(".intro-overlay",{y:-200,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}}),gsap.utils.toArray([".image-small img",".image-large img"]).forEach(e=>{gsap.fromTo(e,{scale:1.3,yPercent:10},{scale:1.2,yPercent:-10,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),gsap.utils.toArray([".image-small img",".image-large img"]).forEach(e=>{gsap.fromTo(e,{scale:1.3,yPercent:10},{scale:1.2,yPercent:-10,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),gsap.utils.toArray(".item-translate").forEach(e=>{var t=parseFloat(e.getAttribute("data-y"))||0;gsap.to(e,{y:t,ease:"none",scrollTrigger:{trigger:"section.intro",start:"top 80%",end:"bottom top",scrub:!0}})}),0<$(".intro").length&&gsap.to(".hero",{y:-150,ease:"none",scrollTrigger:{trigger:".intro",start:"top bottom",end:"top top",scrub:!0}}))}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),sectionFields(),loading(),magicCursor(),effectText(),customDropdown(),hero(),sectionIntro()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0)}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});